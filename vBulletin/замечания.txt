1. Настройки подключения к БД, имена файлов не вынесены в настройки конфигурации.
2. Использование глобальных переменных в классе
3. Размыта логика